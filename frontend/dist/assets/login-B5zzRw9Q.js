import{b as c}from"./util-DwtvpL__.js";const u="https://samvaad-r7bw.onrender.com";let n;function m(){const l=document.getElementById("loginForm");if(!l)return;const r=document.getElementById("loginUserName"),i=document.getElementById("loginUserPassword");function s(o){const e=document.getElementById("loginError");e&&(e.innerText=o,n&&clearTimeout(n),n=setTimeout(()=>{r.value="",i.value="",e.innerText="",n=null},3e3))}async function g(o,e){try{console.log("Logging in with:",o,e);const t=await fetch(`${u}/auth/login`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({username:o,password:e})}),a=await t.json();if(!t.ok){s(a.message||"Login failed");return}localStorage.setItem("token",a.token),localStorage.setItem("user",JSON.stringify(a.user)),typeof window.showChatPage=="function"?(window.showChatPage(),typeof window.startChatApp=="function"?await window.startChatApp():console.warn("startChatApp() not found!")):console.warn("showChatPage() not found!"),r.value="",i.value=""}catch(t){s("Login error: "+t.message),console.error(t)}}l.addEventListener("submit",o=>{o.preventDefault();const e=r.value.trim(),t=i.value.trim();if(c(e,t)){s("Please enter both username and password");return}g(e,t)})}export{m as initLogin};
